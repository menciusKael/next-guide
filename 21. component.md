##Preface

At the beginning of this article, we will enter the components section and provide a detailed introduction to the four built-in components of NextJS, namely: '<Image>', 'Font', '<Link>', and '<Script>'. They are all specially abstracted components optimized by NextJS based on native HTML tags, and should be used as much as possible during development.

The<Image>component implements lazy loading and automatically adjusts image size based on device size, the<Link><span></span>component implements background pre fetch of resources, making page transitions faster and smoother, and the<Script>component allows you to control loading and executing third-party scripts, etc. We will provide detailed information on the specific functions and APIs in the components section.

This article will introduce the<Image>component, as images often occupy a large part of the webpage size, and image optimization is of utmost importance` The Image component also provides a lot of props and configuration items. Understanding these props and their underlying principles helps us to use the Image component more deeply and bring a better user experience.

## Images and LCP

### 1. Image proportion

according to [Web Almanac](https://link.juejin.cn/?target=https%3A%2F%2Falmanac.httparchive.org%2Fen%2F2022%2Fmedia "https://almanac.httparchive.org/en/2022/media") In the introduction, image size accounts for a large part of the typical website page size. According to statistics, the median total size of websites in June 2021 was 2019 KB (mobile), of which 881 KB were images. This is more than the sum of HTML (30 KB), CSS (72 KB), JavaScript (461 KB), and fonts (97 KB).

On the vast majority of pages (70% mobile devices, 80% desktop), the most influential are images. Largest Contentful Paint（Maximum content drawing, abbreviated as：[LCP](https://link.juejin.cn/?target=https%3A%2F%2Fweb.dev%2Farticles%2Flcp%3Fhl%3Dzh-cn "https://web.dev/articles/lcp?hl=zh-cn")） It is a web performance metric that identifies the largest content element in the first screen. Most of the time, this element has an image.

### 2. LCP background

Considering that LCP is not a commonly known concept, we will introduce LCP separately.

For web developers, measuring the loading speed of the main content on a webpage has always been a challenge.

Traditionally, we use methods such as load and DOMContentLoaded, but they do not represent the time the user sees content on the screen.

And for first content rendering (FCP), if the page has a loading effect, the time obtained is also inaccurate.

Of course, there are also indicators such as First Effective Mapping (FMP), but these indicators are very complex and often incorrect. So it cannot be used to determine the loading time of the main content.

According to discussions in the W3C Web Performance Working Group and research by Google, a more accurate way to measure the loading time of the main content of a webpage is to look at the rendering time of the largest element. This is LCP.

### 3. LCP Concepts and Standards

The Large Contentful Paint (LCP) metric reports the rendering time of the largest image or text block visible in the viewport (relative to the time the webpage first starts loading).

In order to provide a good user experience, the website should strive to set the Large Contentful Paint to \* _ 2.5 seconds _ \* or shorter.

Let's take a look at some examples of LCP:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cdad5f872000436386d02af3b2b22ab6~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1600&h=621&s=344333&e=png&b=faf4f4)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d45d5ac94a014e66a4b791e61e2a41dc~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1600&h=621&s=397379&e=png&b=fbfbfb)

So the question is, pages are often loaded in stages, and the largest element in a webpage may be constantly changing. How is LCP calculated?

Firstly, the browser will limit the elements of LCP to specific element types, such as<img>elements, block level elements that contain text nodes or other embedded text elements, the first frame drawn for autoplay of<video>elements, the first frame of animated image formats (such as GIF animations), and so on (this is to simplify the issue, as calculating the size of all elements would be too complex and unnecessary).

Then, after drawing the first frame, the browser will immediately assign a Performance Entry of the large content point type to identify the largest content element. After rendering subsequent frames, as long as the maximum content element changes, the API will assign another Performance Entry. Simply put, when drawing each frame, the browser will indicate the maximum content element.

When the user interacts with the page (by clicking, scrolling, or pressing a button), the browser stops reporting new entries. (Because user interaction often changes the content displayed to the user, such as scrolling operations). Generally speaking, the startTime value of the last entry issued is the LCP value.

## `<Image>`

### 1. Functional characteristics

Explaining LCP is just to help everyone realize the importance of image optimization (after all, the biggest content element is often the image). Returning to the `<Image>` component, NextJS implements these optimization features based on native HTML `<img>` elements:

1. Size optimization: Automatically provide images of the correct size for each device, and also use modern image formats such as WebP and AVIF.
2. Visual stability: prevent layout shift during image loading (Layout Shift)
3. Faster page loading: Images only load when entering the viewport, using lazy loading function and optional use of blurry placeholders
4. Flexible configuration: Adjust images as needed, and images on remote servers can also be adjusted accordingly

We will cover these functions one by one when explaining the component API.

### 2. Basic usage

This is an example of using the<Image>component, which looks like using a normal img element:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// app/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="5">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">      src=&#34;/profile.png&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="8">      width={500}</span>
<span class="code-block-extension-codeLine" data-line-num="9">      height={500}</span>
<span class="code-block-extension-codeLine" data-line-num="10">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="12">  )</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>

### 3. Supported props

`<Image>` The component supports passing in these props:

| **Prop**                                                                                                                                                                                                                          | **Example**                          | **type**        | **Is it necessary** |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------ | --------------- | ------------------- |
| [src](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23src "https://nextjs.org/docs/app/api-reference/components/image#src")                                           | `src="/profile.png"`                 | String          | yes                 |
| [width](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23width "https://nextjs.org/docs/app/api-reference/components/image#width")                                     | `width={500}`                        | Integer (px)    | yes                 |
| [height](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23height "https://nextjs.org/docs/app/api-reference/components/image#height")                                  | `height={500}`                       | Integer (px)    | yes                 |
| [alt](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23alt "https://nextjs.org/docs/app/api-reference/components/image#alt")                                           | `alt="Picture of the author"`        | String          | yes                 |
| [loader](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23loader "https://nextjs.org/docs/app/api-reference/components/image#loader")                                  | `loader={imageLoader}`               | Function        | -                   |
| [fill](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23fill "https://nextjs.org/docs/app/api-reference/components/image#fill")                                        | `fill={true}`                        | Boolean         | -                   |
| [sizes](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23sizes "https://nextjs.org/docs/app/api-reference/components/image#sizes")                                     | `sizes="(max-width: 768px) 100vw"`   | String          | -                   |
| [quality](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23quality "https://nextjs.org/docs/app/api-reference/components/image#quality")                               | `quality={80}`                       | Integer (1-100) | -                   |
| [priority](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23priority "https://nextjs.org/docs/app/api-reference/components/image#priority")                            | `priority={true}`                    | Boolean         | -                   |
| [placeholder](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23placeholder "https://nextjs.org/docs/app/api-reference/components/image#placeholder")                   | `placeholder="blur"`                 | String          | -                   |
| [style](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23style "https://nextjs.org/docs/app/api-reference/components/image#style")                                     | `style={{objectFit: "contain"}}`     | Object          | -                   |
| [onLoadingComplete](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23onloadingcomplete "https://nextjs.org/docs/app/api-reference/components/image#onloadingcomplete") | `onLoadingComplete={img => done())}` | Function        | -                   |
| [onLoad](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23onload "https://nextjs.org/docs/app/api-reference/components/image#onload")                                  | `onLoad={event => done())}`          | Function        | -                   |
| [onError](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23onerror "https://nextjs.org/docs/app/api-reference/components/image#onerror")                               | `onError(event => fail()}`           | Function        | -                   |
| [loading](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23loading "https://nextjs.org/docs/app/api-reference/components/image#loading")                               | `loading="lazy"`                     | String          | -                   |
| [blurDataURL](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fcomponents%2Fimage%23blurdataurl "https://nextjs.org/docs/app/api-reference/components/image#blurdataurl")                   | `blurDataURL="data:image/jpeg..."`   | String          | -                   |

Among them, 'src', 'width', 'height', and 'alt' are mandatory, while others are optional. Let's explain them one by one.

### 4. Src - Required

Src supports passing in a static imported image file and also supports passing in a path string.

When using local images, static import of image files can be used. Import files in. jpg,. png, or. webp formats through 'import'. The usage example is as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// app/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">import profilePic from &#39;./me.png&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="6">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="8">      src={profilePic}</span>
<span class="code-block-extension-codeLine" data-line-num="9">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="10">      // width={500} automatically provided</span>
<span class="code-block-extension-codeLine" data-line-num="11">      // height={500} automatically provided</span>
<span class="code-block-extension-codeLine" data-line-num="12">      // blurDataURL=&#34;data:...&#34; automatically provided</span>
<span class="code-block-extension-codeLine" data-line-num="13">      // placeholder=&#34;blur&#34; // Optional blur-up while loading</span>
<span class="code-block-extension-codeLine" data-line-num="14">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="15">  )</span>
<span class="code-block-extension-codeLine" data-line-num="16">}</span>
</code></pre>

Using a static file import method, 'width' and 'height' do not need to be passed in, Next.exe will automatically provide them.

Note: Dynamic 'await import()' or 'require ()<span></span>' are not supported` Import must be static in order to be analyzed during construction.

When using remote images, src can pass in a URL string.

Due to the inability to retrieve remote files during the construction of NextJS, you need to manually provide 'width', 'height', and optional 'blurDataURL' props.

`The width and height attributes are used to infer the correct aspect ratio (also known as aspect ratio) of an image and to avoid layout offset during image loading. But 'width' and 'height' do not determine the final rendering size of the image, which is also easy to understand because you may also set stretching mode, etc.

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// app/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="5">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">      src=&#34;https://s3.amazonaws.com/my-bucket/profile.png&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="8">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="9">      width={500}</span>
<span class="code-block-extension-codeLine" data-line-num="10">      height={500}</span>
<span class="code-block-extension-codeLine" data-line-num="11">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="12">  )</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>

Note that when using remote addresses, Next.exe requires defining supported remote image addresses in the 'next. config. js' file to prevent malicious use. The configuration method is as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    remotePatterns: [</span>
<span class="code-block-extension-codeLine" data-line-num="5">      {</span>
<span class="code-block-extension-codeLine" data-line-num="6">        protocol: &#39;https&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="7">        hostname: &#39;s3.amazonaws.com&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="8">        port: &#39;&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="9">        pathname: &#39;/my-bucket/**&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="10">      },</span>
<span class="code-block-extension-codeLine" data-line-num="11">    ],</span>
<span class="code-block-extension-codeLine" data-line-num="12">  },</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>

We will provide a detailed explanation of the 'remotePatterns' in the configuration file later in this article.

### 5. Width - Required

`The width property represents the width of the rendered image, measured in pixels, and affects the display size of the image.

This attribute is required, unless it is a static imported image or the image has a 'fill' attribute.

### 6. Height - Required

`The height attribute represents the height of the rendered image, measured in pixels, and affects the display size of the image.

The attribute must be, unless it is a static imported image or the image has a 'fill' attribute.

### 7. alt

`The alt attribute is used to describe images and is provided for use by screen readers and search engines. If the image is disabled or there is an error loading the image, it will serve as a text prompt for downgrading.

`The alt attribute should be used to replace the text description of the image without changing the meaning of the page, and should not repeat the information provided in the title above or below the image.

If the image is purely for decoration or not intended for user use, the 'alt' attribute should be represented by an empty string ('alt='').

### 8. loader

`loader` A custom function for parsing image addresses. Let's take a look at an example code:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&#39;use client&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">const imageLoader = ({ src, width, quality }) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="6">  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`</span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
<span class="code-block-extension-codeLine" data-line-num="8"></span>
<span class="code-block-extension-codeLine" data-line-num="9">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="10">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="12">      loader={imageLoader}</span>
<span class="code-block-extension-codeLine" data-line-num="13">      src=&#34;me.png&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="14">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="15">      width={500}</span>
<span class="code-block-extension-codeLine" data-line-num="16">      height={500}</span>
<span class="code-block-extension-codeLine" data-line-num="17">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="18">  )</span>
<span class="code-block-extension-codeLine" data-line-num="19">}</span>
</code></pre>

The function takes' src ',' width ', and' quality 'as parameters and returns the URL string of the image.

Note: Since the 'loader' prop passes a function, a client component is required, and in this example, 'use client' is also used at the top.

Adding a loader to each image is very cumbersome, but you can also use the 'loaderFile' configuration option in 'next. config. js' to configure each' next/image 'instance in the application without passing the' loader 'prop. This configuration item will be explained later in this article.

### 9. fill

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">fill={true} // {true} | {false}</span>
</code></pre>

`Fill 'indicates whether to fill the image with the parent element. The default value is' false '. It is useful when the width and height of the image are unknown.

However, it should be noted that when using 'fill', the parent element must be specified as' position: 'relative', 'position:' fixed ', or' position: 'absolute'. And the img element will be automatically designated as' position: 'absolute' by default.

If no other styles are applied to the image, it will be stretched to fill the container.

Of course, there are many ways to fill containers, and the CSS properties' object fit: 'container' and 'object fit:' cover 'can also be used to fill images.

Let's take a brief look at the differences:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// app/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">import profilePic from &#39;./image.png&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="6">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="xml">&lt;div style={{</span></span>
<span class="code-block-extension-codeLine" data-line-num="8">      width: &#39;200px&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="9">      height: &#39;200px&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="10">      backgroundColor: &#34;#ccc&#34;,</span>
<span class="code-block-extension-codeLine" data-line-num="11">      position: &#39;relative&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="12">    }}&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="13">     &lt;Image</span>
<span class="code-block-extension-codeLine" data-line-num="14">        src={profilePic}</span>
<span class="code-block-extension-codeLine" data-line-num="15">        alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="16">      /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="17">    &lt;/div&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="18">  )</span>
<span class="code-block-extension-codeLine" data-line-num="19">}</span>
</code></pre>

The normal display is as follows:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea029d04ff6748d297390b2d5a4fbcc9~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=856&h=642&s=500317&e=png&b=2d2a27)

If the fill attribute is added:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&lt;Image</span>
<span class="code-block-extension-codeLine" data-line-num="2">  src={profilePic}</span>
<span class="code-block-extension-codeLine" data-line-num="3">  alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="4">  fill={true}</span>
<span class="code-block-extension-codeLine" data-line-num="5">/&gt;</span>
</code></pre>

The effect is as follows, the image will be stretched to fit the container:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/23133468308c414d8b153bd6689a8495~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=578&h=538&s=265329&e=png&b=302d2b)

If used `object-fit: "contain"`：

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&lt;Image</span>
<span class="code-block-extension-codeLine" data-line-num="2">  src={profilePic}</span>
<span class="code-block-extension-codeLine" data-line-num="3">  alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="4">  fill={true}</span>
<span class="code-block-extension-codeLine" data-line-num="5">  style={{objectFit: &#34;contain&#34;}}</span>
<span class="code-block-extension-codeLine" data-line-num="6">/&gt;</span>
</code></pre>

The effect is as follows: the image fills the entire content box of the element while maintaining its aspect ratio:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b375639f2e14d59923b2cd89440bd6f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=562&h=518&s=174623&e=png&b=ebebeb) If used `object-fit: "cover"`：

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&lt;Image</span>
<span class="code-block-extension-codeLine" data-line-num="2">  src={profilePic}</span>
<span class="code-block-extension-codeLine" data-line-num="3">  alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="4">  fill={true}</span>
<span class="code-block-extension-codeLine" data-line-num="5">  style={{objectFit: &#34;cover&#34;}}</span>
<span class="code-block-extension-codeLine" data-line-num="6">/&gt;</span>
</code></pre>

The effect is as follows: the image fills the entire content box of the element while maintaining its aspect ratio. If the aspect ratio of an object does not match the content box, the object will be cropped to fit the content box:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e02b46bc02941b6b9cf78e584e0578e~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=624&h=532&s=232733&e=png&b=282523)

### 10. sizes

HTML 5.1 has added the 'srcset' and 'sizes' attributes of the img element for setting responsive images.

When we need different devices to display different images, we need to use 'srcset'. There are two specific situations here, one is that the images are of the same size, but different resolutions correspond to different images, that is, high-resolution corresponds to high magnification images. One type is the same image content, but displayed larger or smaller depending on the device. This corresponds to the two syntax of srcset.

First, let's talk about the first method, which displays different images based on different resolutions. Here is an example of how to use it:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&lt;img</span>
<span class="code-block-extension-codeLine" data-line-num="2">  srcset=&#34;elva-fairy-320w.jpg, elva-fairy-480w.jpg 1.5x, elva-fairy-640w.jpg 2x&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="3">  src=&#34;elva-fairy-640w.jpg&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="4">  alt=&#34;Elva dressed as a fairy&#34; /&gt;</span>
</code></pre>

The effect is as follows:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a316177c7f664b9ab520736e62d054d2~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=480&h=425&s=130728&e=png&a=1&b=f4f1f0)

Srcset is composed of one or more strings separated by commas, with each string consisting of the following:

1. URL pointing to the image
2. One space (optional)
3. A pixel density descriptor (a positive floating-point number followed by an x symbol)

If we apply a CSS style to an image:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">img {</span>
<span class="code-block-extension-codeLine" data-line-num="2">  width: 320px;</span>
<span class="code-block-extension-codeLine" data-line-num="3">}</span>
</code></pre>

Its width on the screen is 320 pixels (CSS pixels). The browser calculates the resolution of the display being shown and then displays the most suitable image referenced by the srcset. If it is a normal resolution and one device pixel represents one CSS pixel, then 'elva-fairy-320w. jpg' will be loaded, with a size of 39KB. If the device is a high pixel and two or more device pixels represent one CSS pixel, then 'elva-fairy-640w. jpg' will be loaded, with a size of 93KB.

Speaking of the second scenario, the same image content but displayed larger or smaller depending on the device. The example code is as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&lt;img</span>
<span class="code-block-extension-codeLine" data-line-num="2">  srcset=&#34;elva-fairy-small.jpg 480w, elva-fairy-large.jpg 800w&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="3">  src=&#34;elva-fairy-large.jpg&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="4">  alt=&#34;Elva dressed as a fairy&#34; /&gt;</span>
</code></pre>

The syntax of srcset is slightly different from before, as it defines the image settings that can be selected by the browser and the size of each image. Analyzing its syntax, it is still composed of one or more strings separated by commas, with each string consisting of the following parts:

1. URL pointing to the image
2. One space
3. The inherent width of the image (in pixels). Note that the width descriptor w is used here, not px. But one w corresponds to one pixel. The inherent width of an image refers to its true size.

At this point, we informed the browser that there are two alternative images to display for this image. One is' elva fairy small. jpg 'with a width of 480px, and the other is' elva fairy large. jpg' with a width of 800px.

How does the browser know which image to use? For example, if the current device viewport width is 640px, should we choose a 480px image or an 800px image?

To help the browser determine, you need to write the sizes attribute. The sizes attribute is a set of media query conditions that tell the browser what kind of conditions to use and what kind of images to use. An example of usage is as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&lt;img</span>
<span class="code-block-extension-codeLine" data-line-num="2">  srcset=&#34;elva-fairy-small.jpg 480w, elva-fairy-large.jpg 800w&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="3">  sizes=&#34;(max-width: 600px) 480px,</span>
<span class="code-block-extension-codeLine" data-line-num="4">         800px&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="5">  src=&#34;elva-fairy-large.jpg&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="6">  alt=&#34;Elva dressed as a fairy&#34; /&gt;</span>
</code></pre>

Sizes are also composed of one or more strings separated by commas, with each string consisting of the following:

1. A media condition, in the example of '(max width: 600px)', which represents when the width of the viewport is less than or equal to 600px
2. One space
   When the media conditions are true, the width of the image to be filled can be a fixed value, such as 480px in this example, or a width relative to the viewport (such as 50vw), but not a percentage. If there are no media conditions, it means it takes effect by default. When the browser successfully matches the first media condition, all remaining conditions will be ignored. So the order is very important.

With these attributes, the browser will:

1. Check the width of the equipment
2. Check which media condition in the sizes list is the first to be true
3. Check the slot size given for the media query
4. Load the image closest to the selected slot size referenced in the srcset list

For example, in this example, if the browser viewport is 480px, then the first condition in sizes (max width: 600px) is true, so 480px size is chosen because it is closest to the intrinsic width of 480w, so elva-fairy-small.jpg is loaded. By using this method, it is possible to load small images on mobile devices, thereby accelerating the loading speed of mobile devices.

After discussing the 'srcset' and 'sizes' properties of the img element, return to the'<Image>'component and use NextJS. You don't need to set the' srcset ', NextJS will automatically generate it for you. Setting the sizes attribute will affect the value of the generated 'srcset'.

If you do not set the size attribute of the component, Next.js will use pixel density descriptors such as 1x and 2x, while if you set the size attribute, Next.js will use intrinsic width descriptors such as 640w and 750w.

Before setting:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ca8290c0b4849e6a4c936c1398140c9~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1182&h=124&s=69379&e=png&b=282828)

After setting:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/031333cd47564ad399e819642ae912f7~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1178&h=436&s=253485&e=png&b=282828)

### 11. quality

Indicates optimizing the quality of the image, with a value ranging from 1 to 100, where 100 represents the best quality and also the maximum file size. The default is 75.

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">quality={75} // {number 1-100}</span></code></pre>

### 12. priority

Indicates image loading priority, Boolean type, default value is false. When the value is true, it indicates high priority and preloading. Images using 'priority' will automatically disable lazy loading.

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">priority={false} // {false} | {true}</span>
</code></pre>

There are two suggestions for using this attribute:

1. Use on the visible image on the first screen
2. When using LCP image elements, considering that different viewport widths may have different LCP images, multiple LCP images can be set

When running 'next dev', if the LCP element is an image but the priority property is not set, there will be a warning in the console:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d5a914226438476ca76d26e481b6a6c8~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1398&h=104&s=54212&e=png&b=3f3a2e)

use example code:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// app/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">import profilePic from &#39;../public/me.png&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="6">  return <span class="xml">&lt;Image src={profilePic} alt=&#34;Picture of the author&#34; priority /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
</code></pre>

### 13. placeholder

Represents a placeholder for loading images. The optional values are 'blur', 'empty', 'data: image/...'< Span></span>`, the default value is ` empty `.

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">placeholder = &#39;empty&#39; // &#34;empty&#34; | &#34;blur&#34; | &#34;data:image/...&#34;</span>
</code></pre>

When the value is' empty ', there will be no placeholders during loading, only blank areas.

The value is ` data: image/` When using [Data URL](https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTTP%2FBasics_of_HTTP%2FData_URLs "https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Data_URLs") As a placeholder image during image loading. Data URL， The URL with the prefix 'data:' protocol allows content creators to embed small files into the document. For example, a base64 image is a Data URL.

When the value is' blur ', the value of the' blurDataURL 'attribute will be used as a placeholder image. If the image is statically imported and the imported image is `. jpg `, `. png `, `. webp ` or `. avif `, the blurDataURL will be automatically generated, except for dynamic images. If it is a dynamic image, the 'blurDataURL' attribute must be provided.

It is a default [blur ](https://link.juejin.cn/?target=https%3A%2F%2Fimage-component.nextjs.gallery%2Fplaceholder "https://image-component.nextjs.gallery/placeholder")：

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/74b6fe2095ec48e8ba8748518f50ee4b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=803&h=575&s=123548&e=gif&f=6&b=66868d)

### 14. blurDataURL

This property value will only take effect when you set 'placeholder=' blur ''.

It must be a base64 encoded image. The image will be enlarged and blurred, it is recommended to use a very small image (10px or smaller).

This can be achieved with the help of blurDataURI [color effects](https://link.juejin.cn/?target=https%3A%2F%2Fimage-component.nextjs.gallery%2Fplaceholder "https://image-component.nextjs.gallery/placeholder")：

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2aa039c8c7034d3b9a38a67de8c28126~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=750&h=1020&s=326943&e=gif&f=8&b=e4b23f)

You can use [png-pixel.com/](https://link.juejin.cn/?target=https%3A%2F%2Fpng-pixel.com%2F "https://png-pixel.com/") Quickly obtain a data URL for a solid color image.

### 15. style

Set the style of the image

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// components/ProfileImage.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">const imageStyle = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  borderRadius: &#39;50%&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="4">  border: &#39;1px solid #fff&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="5">}</span>
<span class="code-block-extension-codeLine" data-line-num="6"></span>
<span class="code-block-extension-codeLine" data-line-num="7">export default function ProfileImage() {</span>
<span class="code-block-extension-codeLine" data-line-num="8">  return <span class="xml">&lt;Image src=&#34;...&#34; style={imageStyle} /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="9">}</span>
</code></pre>

When you use style to modify the width of an image, be sure to set 'height' to 'auto' to maintain the aspect ratio, otherwise the image will be distorted. This is because Next.js automatically adds' width 'and' height 'attributes to the image. By using the style style to only modify the width, adding the originally added' height 'attribute will cause the image to deform.

### 6. onLoadingComplete

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&#39;use client&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">&lt;Image onLoadingComplete={(img) =&gt; console.log(img.naturalWidth)} /&gt;</span>
</code></pre>

When the image is loaded, the callback function will be executed and the placeholder image will be deleted. ![](https://juejin.cn/book/7307859898316881957/section/7309077545142616091) A reference to an element.

Note: Because the component receives a function as a parameter, you need to use a client component.

### 17. onLoad

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&#39;use client&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">&lt;Image onLoad={(e) =&gt; console.log(e.target.naturalWidth)} /&gt;</span>
</code></pre>

Also executed when the image is loaded, this callback function may be executed before the placeholder is deleted and the image is fully decoded. So if you want to wait until the image is fully loaded, use onLoadingComplete.

Note: Because the component receives a function as a parameter, you need to use a client component.

### 18. onError

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&#39;use client&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">&lt;Image onError={(e) =&gt; console.error(e.target.id)} /&gt;</span>
</code></pre>

A callback function that is executed when the image fails to load.

Note: Because the component receives a function as a parameter, a client component is required.

### 19. loading

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">loading = &#39;lazy&#39; // {lazy} | {eager}</span>
</code></pre>

Set the loading behavior of the image, the default value is `lazy`.

When the value is `lazy`, the image will be delayed until the image is close to the viewport.

When the value is `eager`, the image will be loaded immediately.

Using `eager` usually hurts performance. Next.js recommends using the `priority` property instead.

### 20. unoptimized

Cancel optimization. When the value is `true`, the original image is used without changing the quality, size, or format. The default value is `false`. Examples are as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">const UnoptimizedImage = (props) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="4">  return <span class="xml">&lt;Image {...props} unoptimized /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="5">}</span>
</code></pre>

Starting from Next.js 12.3.0, you can disable optimization for all images via `next.config.js`:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    unoptimized: true,</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
</code></pre>

### 21. Other props

Other props passed to the `<Image />` component will be passed to the underlying img element. The following are the exceptions:

1. `srcSet`, which is automatically generated by Next.js. If you want to change it, use the deviceSizes configuration, which will be discussed in the next section.
2. `decoding`, which is always `"async"`

## Configuration options

In addition to props, you can also configure the image component in `next.config.js`.

### 1. remotePatterns

To protect your app from malicious users, you need to configure `remotePatterns` when using external images:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    remotePatterns: [</span>
<span class="code-block-extension-codeLine" data-line-num="5">      {</span>
<span class="code-block-extension-codeLine" data-line-num="6">        protocol: &#39;https&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="7">        hostname: &#39;example.com&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="8">        port: &#39;&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="9">        pathname: &#39;/account123/**&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="10">      },</span>
<span class="code-block-extension-codeLine" data-line-num="11">    ],</span>
<span class="code-block-extension-codeLine" data-line-num="12">  },</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>

This example means that the value of the `src` attribute of `next/image` must start with `https://example.com/account123/`. Other protocols, hostnames, ports, or unmatched paths will return a 400 error.

Here is another example, in which wildcards are used:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    remotePatterns: [</span>
<span class="code-block-extension-codeLine" data-line-num="5">      {</span>
<span class="code-block-extension-codeLine" data-line-num="6">        protocol: &#39;https&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="7">        hostname: &#39;**.example.com&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="8">      },</span>
<span class="code-block-extension-codeLine" data-line-num="9">    ],</span>
<span class="code-block-extension-codeLine" data-line-num="10">  },</span>
<span class="code-block-extension-codeLine" data-line-num="11">}</span>
</code></pre>

This example means that the value of the `src` attribute of `next/image` must start with `https://xxx.example.com`, `https://xxx.xxx.example.com`, `https://xxx.xxx.xxx.example.com`, etc.

Both `pathname` and `hostname` can use wildcards, where:

1. `*` means matching a single route segment or subdomain
2. `**` means matching any number of route segments or subdomains.

Note that the `**` syntax does not work in the middle of the pattern.

### 2. domains

Deprecated since Next.js 14 in favor of the more strict `remotePatterns`. Use only if all content comes from a domain you control.

Similar to `remotePatterns`, the `domains` config takes a list of hostnames to use for external images:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    domains: [&#39;assets.acme.com&#39;],</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
</code></pre>

But note that `domains` does not support wildcards, and cannot restrict protocols, ports or path names. So it is more recommended to use `remotePatterns`.

### 3. loaderFile

If you do not want to use the built-in image optimization API of Next.js, you can configure it yourself, using the `loaderFile` configuration item of `next.config.js`:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    loader: &#39;custom&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="5">    loaderFile: &#39;./my/image/loader.js&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="6">  },</span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
</code></pre>

`loaderFile` must point to a file relative to the Next.js application root directory. The file must export a default function that returns a string. For example:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">&#39;use client&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">export default function myImageLoader({ src, width, quality }) {</span>
<span class="code-block-extension-codeLine" data-line-num="4">  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`</span>
<span class="code-block-extension-codeLine" data-line-num="5">}</span>
</code></pre>

This applies to all instances of `next/image`. If you want to modify individual images, use the `loader` prop.

### 4. deviceSizes

If you know the width of the user's device, you can use `deviceSizes` in `next.config.js` to declare a series of device width breakpoints. When the `next/image` component uses the `sizes` prop, these widths will be used to infer the correct image to load.

If not configured, the default values ​​are:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span></code></pre>

### 5. imageSizes

You can declare a range of image widths using the `imageSize` property in `next.config.js`.

If not configured, the default values ​​are:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
</code></pre>

`imageSize` and `deviceSizes` will affect the final `srcset` size generated by the image:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/186de6c29889461b9d4e2a0b6697481b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1178&h=436&s=253485&e=png&b=282828)
So the question is, since they are all used to generate the final `srcset`, can't we just use one array? Why do we have to use two arrays?

You can understand it this way, `deviceSizes` is used to process large images, `imageSizes` is used to process small images, and `imageSizes` will only take effect when the image uses the `sizes` prop, for example, when you write:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2">import profilePic from &#39;./image.png&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">export default function Page() {</span>
<span class="code-block-extension-codeLine" data-line-num="5">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">      src={profilePic}</span>
<span class="code-block-extension-codeLine" data-line-num="8">      sizes=&#34;(max-width: 600px) 160px,</span>
<span class="code-block-extension-codeLine" data-line-num="9">      320px&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="10">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="12">  )</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>

The corresponding generated `srcset` contains all sizes of deviceSizes and imageSizes:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e64c0676e9f4c7ab906f3cdf31fab8f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1076&h=606&s=333340&e=png&b=282828)

When you use the `sizes` prop, it means that the image width is smaller than the full screen width. All values ​​in `imagesSizes` should be smaller than the minimum value in `deviceSizes`.

### 6. formats

Next.js's default image optimization API automatically detects the image formats supported by the browser through the Accept request header in the request.

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a1a458a9d4fb4ae6a2bb54db2ecd4766~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=980&h=146&s=29237&e=png&b=292929)

If `Accept` matches multiple configured formats, the first one in the array will be used first. Therefore, the order of the array is important. If no match is found or the source image is a moving image, the image optimization API will automatically fall back to the original image format.

If not configured, the default value is:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    formats: [&#39;image/webp&#39;],</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
</code></pre>

You can enable AVIF format support using the following configuration:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    formats: [&#39;image/avif&#39;, &#39;image/webp&#39;],</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span></code></pre>

### 7. minimumCacheTTL

Images are dynamically optimized based on requests and stored in the `<distDir>/cache/images` directory. The optimized image files are used for subsequent requests until the cache expires. When an expired file is matched, the expired image will be immediately invalidated, and the image will be re-optimized in the background and stored in the cache with a new expiration date.

The cache status of the image is determined by reading the `x-nextjs-cache` header in the response header:

- `MISS`: the path is not in the cache
- `STALE`: the path is cached but the revalidation time has exceeded, it will be updated in the background
- `HIT`: the path is in the cache and the revalidation time has not exceeded

The expiration time can be defined in two ways:

One is through the `minimumCacheTTL` configuration item, and the other is through the `Cache-Control` header, specifically, using the `max-age` field of the `Cache-Control` header. If both `s-maxage` and `max-age` are present, `s-maxage` takes precedence.

If both methods are set at the same time, the larger one will prevail.

The `minimumCacheTTL` configuration item is used to set the expiration time of cache optimized images, which is in seconds. The usage example is as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    minimumCacheTTL: 60,</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
</code></pre>

If you need to change the caching behavior for each image, you can do so via [headers](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Fnext-config-js%2Fheaders "https://nextjs.org/docs/app/api-reference/next-config-js/headers") Configure image resources `Cache-Control`Header。

Most of the time, it is recommended to use static image imports, which automatically hash the file content and use the `Cache-Control` header of `immutable`.

There is currently no mechanism to revalidate the cache, so it is best to set the value of `minimumCacheTTL` to a lower value, otherwise you may need to manually modify the `src` prop or delete `<distDir>/cache/images` to update the cache.

### 8. disableStaticImages

If the image static import feature conflicts with other plugins and you want to disable this feature:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js </span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    disableStaticImages: true,</span>
<span class="code-block-extension-codeLine" data-line-num="5">  },</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
</code></pre>

### 9. dangerouslyAllowSVG

The default loader does not optimize SVG images. First, SVG is a vector format, which means it can be resized losslessly. Second, SVG has many of the same features as HTML/CSS, which can lead to vulnerabilities without a proper content security policy.

If you need to serve SVG images using the default image optimization API, set the `dangerouslyAllowSVG` value in `next.config.js`:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// next.config.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">module.exports = {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  images: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">    dangerouslyAllowSVG: true,</span>
<span class="code-block-extension-codeLine" data-line-num="5">    contentDispositionType: &#39;attachment&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="6">    contentSecurityPolicy: &#34;default-src &#39;self&#39;; script-src &#39;none&#39;; sandbox;&#34;,</span>
<span class="code-block-extension-codeLine" data-line-num="7">  },</span>
<span class="code-block-extension-codeLine" data-line-num="8">}</span>
</code></pre>

Next.js strongly recommends setting `contentDispositionType` to force the browser to download images, and `contentSecurityPolicy` to prevent the execution of scripts embedded in images.

## Animated images

The default loader will automatically skip the optimization of dynamic images and display them as is.

Next.js will automatically detect dynamic images and supports GIF, APNG and WebP formats. For specific dynamic images, if you want to explicitly skip them, use the `unoptimized` attribute (this saves Next.js from detecting and judging).

## Responsive images

The default `srcset` generated by the image includes `1x` and `2x` images, which is to support different device pixel ratios. However, sometimes you want to render responsive images and automatically adapt to the viewport. At this time, you need to set `sizes` and `style` (or `className`). The following methods can be used to render responsive images:

### 1. Responsive images using static imports

If the source image is not dynamic, you can create a responsive image using a static import:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// components/author.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">import me from &#39;../photos/me.jpg&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">export default function Author() {</span>
<span class="code-block-extension-codeLine" data-line-num="6">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="8">      src={me}</span>
<span class="code-block-extension-codeLine" data-line-num="9">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="10">      sizes=&#34;100vw&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="11">      style={{</span>
<span class="code-block-extension-codeLine" data-line-num="12">        width: &#39;100%&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="13">        height: &#39;auto&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="14">      }}</span>
<span class="code-block-extension-codeLine" data-line-num="15">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="16">  )</span>
<span class="code-block-extension-codeLine" data-line-num="17">}</span>
</code></pre>

### 2. Responsive images that maintain aspect ratio

If the source image is a dynamic or remote URL, you need to provide `width` and `height` to set the correct responsive image aspect ratio.

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// components/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">export default function Page({ photoUrl }) {</span>
<span class="code-block-extension-codeLine" data-line-num="5">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="xml">&lt;Image</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">      src={photoUrl}</span>
<span class="code-block-extension-codeLine" data-line-num="8">      alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="9">      sizes=&#34;100vw&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="10">      style={{</span>
<span class="code-block-extension-codeLine" data-line-num="11">        width: &#39;100%&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="12">        height: &#39;auto&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="13">      }}</span>
<span class="code-block-extension-codeLine" data-line-num="14">      width={500}</span>
<span class="code-block-extension-codeLine" data-line-num="15">      height={300}</span>
<span class="code-block-extension-codeLine" data-line-num="16">    /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="17">  )</span>
<span class="code-block-extension-codeLine" data-line-num="18">}</span>
</code></pre>

### 3. Responsive images using the fill attribute

If you don't know the aspect ratio of the image, you can consider using the `fill` attribute. Note that you don't need to set the parent element to `position:relative`. You can also use `object-fit`, depending on what effect you want:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// app/page.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">export default function Page({ photoUrl }) {</span>
<span class="code-block-extension-codeLine" data-line-num="5">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="xml">&lt;div style={{ position: &#39;relative&#39;, width: &#39;500px&#39;, height: &#39;300px&#39; }}&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">      &lt;Image</span>
<span class="code-block-extension-codeLine" data-line-num="8">        src={photoUrl}</span>
<span class="code-block-extension-codeLine" data-line-num="9">        alt=&#34;Picture of the author&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="10">        sizes=&#34;500px&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="11">        fill</span>
<span class="code-block-extension-codeLine" data-line-num="12">        style={{</span>
<span class="code-block-extension-codeLine" data-line-num="13">          objectFit: &#39;contain&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="14">        }}</span>
<span class="code-block-extension-codeLine" data-line-num="15">      /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="16">    &lt;/div&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="17">  )</span>
<span class="code-block-extension-codeLine" data-line-num="18">}</span>
</code></pre>

### 4. Implementation with grid

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6e595921c0a46468e0ad8f18decc19f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1600&h=592&s=256302&e=png&b=1a1a1a)

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="2">import mountains from &#39;../public/mountains.jpg&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">export default function Fill() {</span>
<span class="code-block-extension-codeLine" data-line-num="5">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="xml">&lt;div</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">      style={{</span>
<span class="code-block-extension-codeLine" data-line-num="8">        display: &#39;grid&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="9">        gridGap: &#39;8px&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="10">        gridTemplateColumns: &#39;repeat(auto-fit, minmax(400px, auto))&#39;,</span>
<span class="code-block-extension-codeLine" data-line-num="11">      }}</span>
<span class="code-block-extension-codeLine" data-line-num="12">    &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="13">      &lt;div style={{ position: &#39;relative&#39;, height: &#39;400px&#39; }}&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="14">        &lt;Image</span>
<span class="code-block-extension-codeLine" data-line-num="15">          alt=&#34;Mountains&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="16">          src={mountains}</span>
<span class="code-block-extension-codeLine" data-line-num="17">          fill</span>
<span class="code-block-extension-codeLine" data-line-num="18">          sizes=&#34;(min-width: 808px) 50vw, 100vw&#34;</span>
<span class="code-block-extension-codeLine" data-line-num="19">          style={{</span>
<span class="code-block-extension-codeLine" data-line-num="20">            objectFit: &#39;cover&#39;, // cover, contain, none</span>
<span class="code-block-extension-codeLine" data-line-num="21">          }}</span>
<span class="code-block-extension-codeLine" data-line-num="22">        /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="23">      &lt;/div&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="24">      {/* And more images in the grid... */}</span>
<span class="code-block-extension-codeLine" data-line-num="25">    &lt;/div&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="26">  )</span>
<span class="code-block-extension-codeLine" data-line-num="27">}</span>
</code></pre>

## Subject judgment

If you want to display different images in light and dark mode, you can create a new component containing two `<Image>` components, and then use CSS media queries to display the correct one:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// omponents/theme-image.module.css</span>
<span class="code-block-extension-codeLine" data-line-num="2">.imgDark {</span>
<span class="code-block-extension-codeLine" data-line-num="3">  display: none;</span>
<span class="code-block-extension-codeLine" data-line-num="4">}</span>
<span class="code-block-extension-codeLine" data-line-num="5"></span>
<span class="code-block-extension-codeLine" data-line-num="6">@media (prefers-color-scheme: dark) {</span>
<span class="code-block-extension-codeLine" data-line-num="7">  .imgLight {</span>
<span class="code-block-extension-codeLine" data-line-num="8">    display: none;</span>
<span class="code-block-extension-codeLine" data-line-num="9">  }</span>
<span class="code-block-extension-codeLine" data-line-num="10">  .imgDark {</span>
<span class="code-block-extension-codeLine" data-line-num="11">    display: unset;</span>
<span class="code-block-extension-codeLine" data-line-num="12">  }</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// components/theme-image.tsx</span>
<span class="code-block-extension-codeLine" data-line-num="2">import styles from &#39;./theme-image.module.css&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">import Image from &#39;next/image&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">const ThemeImage = (props) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="6">  const { srcLight, srcDark, ...rest } = props</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">  return (</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="xml">&lt;&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="10">      &lt;Image {...rest} src={srcLight} className={styles.imgLight} /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="11">      &lt;Image {...rest} src={srcDark} className={styles.imgDark} /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="12">    &lt;/&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="13">  )</span>
<span class="code-block-extension-codeLine" data-line-num="14">}</span>
</code></pre>

## Cumulative layout shift

When using Next.js image components, you will find that Next.js requires width and height attributes. Even if you use the static import method, you just don't have to write these two attributes yourself. Next.js will still automatically add width and height for you. The reason for doing this is to prevent layout shift. The so-called layout shift, as the name suggests, is that the position of the original content suddenly shifts, which often occurs when loading. There are many reasons for layout shift, and the lack of image size is a common reason. Let's take a look at a demonstration video:

![10TEOBGBqZm1SEXE7KiC.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/84c33fdc9221466284dc5507a3573638~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1920&h=1080&s=578501&e=gif&f=238&b=fdfcff)

This is the layout offset caused by not setting the image size. What if the size is set:

![38UiHViz44OWqlKFe1VC.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/37363353c8254f8c8f85010e5d9e9211~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1920&h=1080&s=782430&e=gif&f=187&b=fdfcff)

You will find that when the image is loading, the browser reserves space for the image.

Don’t underestimate layout shift. There is a web performance metric called Cumulative Layout Shift (CLS) for this purpose.[Core Web Index](https://link.juejin.cn/?target=https%3A%2F%2Fweb.dev%2Farticles%2Fvitals%3Fhl%3Dzh-cn%23core_web_vitals "https://web.dev/articles/vitals?hl=zh-cn#core_web_vitals")The cumulative layout shift counts the amount of movement of the visible content in the viewport and the distance it moves, and then calculates a score.

`next/image` is designed to prevent layout shifts, so if you want to resize an image, you should use one of the following three methods:

1. Automatic static import
2. Explicitly declare `width` and `height` attributes
3. Implicitly declare the image to fill the parent element by using fill
