##Preface

The routing segment configuration options have been mentioned multiple times in previous articles, which can configure the behavior of pages, layouts, and routing handlers. In this article, we will provide a detailed introduction to the configuration content.

## 1. Segment

If you go through the official documentation of Next.js (in English), you will often find the word Segment, which means:

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1795b49110b1459081bb3672aeb4bd31~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=992&h=848&s=193982&e=png&b=1c1e20)

For simplicity, I translated it as' paragraph '. When placing a segment in the URL scenario:

\*_URL Segment _ _ refers to a portion of the URL Path separated by slashes _ _ URL Path _ \* refers to the URL portion after the domain name (URL Path is composed of URL Segments)

Use this image to illustrate more clearly:

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b20bb421ef334b9699bc7773c6f67fa7~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1600&h=371&s=223859&e=png&b=131313)

When placing a segment in the Route scenario:

\*_Router Segment _ \*, I translate it as "route segment", where each folder in the route represents a route segment. Each routing segment is mapped to a corresponding URL segment:

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/83ecaf2828ef4e668a4146812ff7c9f3~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1600&h=594&s=339521&e=png&b=141414)

In this image, '/dashboard/settings' consists of three segments:

*`/`: Root Segment
*Dashboard: Segment
\*Settings: Leaf Segment

PS: Leaf segment refers to a segment without child nodes

## 2. Route Segment Config

Next, we will move on to the main topic of this chapter - route segment configuration.

The routing segment configuration options can configure the behavior of pages, layouts, and routing handlers. For example, when we use fetch, we can configure the 'update date' of a specific request separately. With the help of route segment configuration, we can configure the 'update date' of all fetch requests under this route.

The usage of routing segment configuration is also very simple, just export a convention variable name, for example:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// layout.js | page.js | route.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">export const dynamic = &#39;auto&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">export const dynamicParams = true</span>
<span class="code-block-extension-codeLine" data-line-num="4">export const revalidate = false</span>
<span class="code-block-extension-codeLine" data-line-num="5">export const fetchCache = &#39;auto&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="6">export const runtime = &#39;nodejs&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="7">export const preferredRegion = &#39;auto&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="8">export const maxDuration = 5</span>
<span class="code-block-extension-codeLine" data-line-num="9"></span>
<span class="code-block-extension-codeLine" data-line-num="10">export default function MyComponent() {}</span>
</code></pre>

The specific types of variable names and values are:

| \* _ Variable Name _ \*                                                                                                                                                                                                                                               | \* _ Type _ \*                                                                                                            | \* _ Default Value _ \*      |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- | ---------------------------- |
| [dynamic](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23dynamic "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#dynamic")                         | `'auto' \| 'force-dynamic' \| 'error' \| 'force-static'`                                                                  | `'auto'`                     |
| [dynamicParams](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23dynamicparams "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams")       | `boolean`                                                                                                                 | `true`                       |
| [revalidate](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23revalidate "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#revalidate")                | `false \| 'force-cache' \| 0 \| number`                                                                                   | `false`                      |
| [fetchCache](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23fetchcache "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#fetchcache")                | `'auto' \| 'default-cache' \| 'only-cache' \| 'force-cache' \| 'force-no-store' \| 'default-no-store' \| 'only-no-store'` | `'auto'`                     |
| [runtime](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23runtime "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#runtime")                         | `'nodejs' \| 'edge'`                                                                                                      | `'nodejs'`                   |
| [preferredRegion](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23preferredregion "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#preferredregion") | `'auto' \| 'global' \| 'home' \| string \| string[]`                                                                      | `'auto'`                     |
| [maxDuration](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fapi-reference%2Ffile-conventions%2Froute-segment-config%23maxduration "https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#maxduration")             | `number`                                                                                                                  | Deployment Platform Settings |

Note that the values of the configuration options are currently statically analyzed, which means that configuring 'revalidate=600' is valid, but 'revalidate=60 \* 10' is invalid.

Let's explain the functions of these configuration options one by one.

### 2.1. dynamic

Changing the layout or dynamic behavior of a page, the use case is as follows:

<pre><div class="code-block-extension-header"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">// layout.js | page.js | route.js</span>
<span class="code-block-extension-codeLine" data-line-num="2">export const dynamic = &#39;auto&#39;</span>
<span class="code-block-extension-codeLine" data-line-num="3">// &#39;auto&#39; | &#39;force-dynamic&#39; | &#39;error&#39; | &#39;force-static&#39;</span>
</code></pre>

To explain the options for dynamic parameters, let's first review the basic knowledge:

The so-called \* _ Static Rendering _ \* refers to the routing rendering during construction or background rendering after revalidation, and the results will be cached and pushed to CDN. Suitable for situations where user personalization is not targeted and data is known, such as static blog posts, product introduction pages, etc.

The so-called \* _ Dynamic Rendering _ \* refers to the rendering of routing at the request time, which is suitable for personalized or dependent information in the request (such as cookies, URL parameters) for users.

Because rendering mode and data caching are independent of each other, in dynamic rendering, data requests are also divided into caching and non caching（[uncached data request](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fbuilding-your-application%2Fdata-fetching%2Ffetching-caching-and-revalidating%23opting-out-of-data-caching "https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#opting-out-of-data-caching")）of The default is caching, and the advantage of doing so is that even if dynamic rendering is selected, there is no need to worry about the performance impact of obtaining all data during rendering.

`Dynamic not only affects the rendering mode, but also the way data is cached.

There is also a term called \* _ Dynamic Functions _ \*, which refers to functions that obtain information (such as cookies, request headers, URL parameters) that can only be obtained at the time of a request. In Next.js, the corresponding functions are 'cookies',' headers', 'useSearchParams()', and 'searchParams()'. If any of these functions are used, it will cause the route to dynamically render.

Next, we will explain the functions of the values of 'dynamic':

_'auto' (default): Automatic judgment
_'force dynamic', which forces dynamic rendering and exits all fetch request caches, is equivalent to:
*Under Page Router, 'getServerSideProps()' is used` *Set each 'fetch()' request in the layout or page to '{cache:'no-store', next: {update: 0}} '`
*Set the routing segment configuration 'export const fetchCache=' force no store '`
\*'error' forces static rendering and caching of data, if a component uses dynamic functions or does not cache data requests（[uncached data request](https://link.juejin.cn/?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fbuilding-your-application%2Fdata-fetching%2Ffetching-caching-and-revalidating%23opting-out-of-data-caching "https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#opting-out-of-data-caching")），This will lead to errors, equivalent to:

*Under Page Router, 'getStatisticDrops()' was used` *Set each 'fetch()' request in the layout or page to '{cache:' force cache '}'`
*Set the routing segment configuration 'fetchCache=' only cache ', dynamicParams = false` *Setting 'dynamic=' error 'will change the default value of' dynamicParams' from 'true' to 'false'`
*Force static "forces static rendering and caching of data, and forces cookies, headers, and useSearchParams() to return null values.
